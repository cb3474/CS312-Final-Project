<%- include('partials/header') %>

<div class="recipe-header">
  <div class="recipe-image">
    <% if (recipe.image_url) { %>
      <img src="<%= recipe.image_url %>" alt="<%= recipe.title %>">
    <% } else { %>
      <div class="placeholder-image">No Image</div>
    <% } %>
  </div>

  <div class="recipe-info">
    <h1 class="recipe-title"><%= recipe.title %></h1>
    <div class="recipe-rating">
      <div class="rating" data-id="<%= recipe.id %>">
        <% for(let i = 5; i >= 1; i--) { %>
          <span data-value="<%= i %>">&#9733;</span>
        <% } %>
      </div>
    </div>
    <div class="recipe-details">
      <p><strong>By:</strong> <%= recipe.author %></p>
      <p><strong>Cuisine:</strong> <%= recipe.cuisine %></p>
      <p><strong>Meal Type:</strong> <%= recipe.meal_type %></p>
      <p><strong>Difficulty:</strong> <%= recipe.difficulty %></p>
      <p><strong>Cooking Time:</strong> <%= recipe.cooking_time %> mins</p>
    </div>
  </div>
</div>

<h3>Ingredients</h3>
<ul>
  <% ingredients.forEach(i => { %>
    <li><%= i.name %></li>
  <% }) %>
</ul>

<h3>Tags</h3>
<p>
  <% tags.forEach(t => { %>
    <span class="tag"><%= t.name %></span>
  <% }) %>
</p>

<h3>Instructions</h3>
<p><%= recipe.instructions %></p>

<a href="/" class="back-link">‚Üê Back to recipes</a>

<script src="/rating.js"></script>
<%- include('partials/footer') %>

<h3>Comments</h3>

<div class="comments-section">
  <% if (comments && comments.length) { %>
  <% comments.forEach(comment => { %>
    <div class="comment">
      <p><strong><%= comment.username %>:</strong> <%= comment.content %></p>
    </div>
  <% }) %>

  <% } else { %>
    <p>No comments yet. Be the first to comment!</p>
  <% } %>
</div>

<h4>Add a Comment</h4>
<form action="/recipe/<%= recipe.id %>/comment" method="POST">
  <input type="text" name="username" placeholder="Your name" required>
  <textarea name="content" placeholder="Your comment" required></textarea>
  <button type="submit">Post Comment</button>
</form>


